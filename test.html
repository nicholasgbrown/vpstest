<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Xebra-Max Comms Test</title>
    <style>
        html,
        body {
          background-color: black;
            margin: 0 auto;
        }
    </style>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.6/p5.js"></script>
    <script type="text/javascript" src="https://cycling74.s3.amazonaws.com/download/xebra.js"></script>
</head>

<body>
    <script type="text/javascript">
        var xPos = width/2;

        function setup() {

            createCanvas(1024, 768); // native resolution of NEC NP2250 projector

            var xebraState; // variable to represent connection to max

            var options = {
                hostname: "localhost",
                port: 8086,
                supported_objects: Xebra.SUPPORTED_OBJECTS
            };

            xebraState = new Xebra.State(options);

            // not sure you need to listen for objects added
            // xebraState.on("object_added", function(object) {
            //     if (object.getParamValue("varname") === "slider1") {
            //         slider1 = object._id;
            //     }
            //     // add more if statements to control max objects here
            // });

            xebraState.on("object_changed", function(object) {
                if (object.getParamValue("varname") === "slider1") {
                    xPos = object.getParamValue("distance");
                }
            });

            xebraState.connect();
        }

        function draw() {

            background(255);

            fill(0);
            rect(xPos, height/2, 50, 50);

            console.log(xPos);
        }
    </script>
</body>

</html>
